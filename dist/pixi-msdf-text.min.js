!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["text-msdf"]=t():e["text-msdf"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports=require("pixi.js")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);t.MSDFText=o.MSDFText;var n=r(3);t.MSDFRenderer=n.MSDFRenderer},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){function t(t,r){var o=e.call(this,r.texture||PIXI.Texture.WHITE)||this;return o._text=t,o._font={fontFace:r.fontFace,fontSize:r.fontSize,color:void 0===r.fillColor?16711680:r.fillColor,weight:void 0===r.weight?.5:1-r.weight,align:r.align,kerning:void 0===r.kerning||r.kerning,strokeColor:r.strokeColor||0,dropShadow:r.dropShadow||!1,dropShadowColor:r.dropShadowColor||0,dropShadowAlpha:void 0===r.dropShadowAlpha?.5:r.dropShadowAlpha,dropShadowBlur:r.dropShadowBlur||0,dropShadowOffset:r.dropShadowOffset||new n.Point(2,2),pxrange:void 0===r.pxrange?3:r.pxrange},void 0===r.strokeThickness||0===r.strokeThickness?o._font.strokeWeight=0:o._font.strokeWeight=o._font.weight-r.strokeThickness,o._baselineOffset=void 0===r.baselineOffset?0:r.baselineOffset,o._letterSpacing=void 0===r.letterSpacing?0:r.letterSpacing,o._lineSpacing=void 0===r.lineSpacing?0:r.lineSpacing,o._textWidth=o._textHeight=0,o._maxWidth=r.maxWidth||0,o._anchor=new n.ObservablePoint(function(){o.dirty++},o,0,0),o._textMetricsBound=new n.Rectangle,o._debugLevel=r.debugLevel||0,o.pluginName="msdf",o.dirty=0,o.updateText(),o}return o(t,e),t.prototype.updateText=function(){var e=n.extras.BitmapText.fonts[this._font.fontFace];if(!e)throw new Error("Invalid fontFace: "+this._font.fontFace);this._texture=this.getBitmapTexture(this._font.fontFace),this._font.rawSize=e.size;for(var t=this._font.fontSize/e.size,r=new n.Point(0,-this._baselineOffset*t),o=[],i=[],a=this._texture.width,s=this._texture.height,h=-1,d=0,u=0,f=0,l=-1,c=0,p=0,x=0,g=0;g<this._text.length;g++){var m=this._text.charCodeAt(g);if(/(\s)/.test(this._text.charAt(g))&&(l=g,c=d),/(?:\r\n|\r|\n)/.test(this._text.charAt(g)))d-=this._letterSpacing,i.push(d),u=Math.max(u,d),f++,r.x=0,r.y+=e.lineHeight*t+this._lineSpacing*t,h=-1;else if(-1!==l&&this._maxWidth>0&&r.x>this._maxWidth)PIXI.utils.removeItems(o,l-p,g-l),g=l,l=-1,++p,c-=this._letterSpacing,i.push(c),u=Math.max(u,c),f++,r.x=0,r.y+=e.lineHeight*t+this._lineSpacing*t,h=-1;else{var w=e.chars[m];w&&(this._font.kerning&&-1!==h&&w.kerning[h]&&(r.x+=w.kerning[h]*t),o.push({line:f,charCode:m,drawRect:new n.Rectangle(r.x+w.xOffset*t,r.y+w.yOffset*t,w.texture.width*t,w.texture.height*t),rawRect:new n.Rectangle(w.texture.orig.x,w.texture.orig.y,w.texture.width,w.texture.height)}),r.x+=(w.xAdvance+this._letterSpacing)*t,d=r.x,x=Math.max(x,r.y+e.lineHeight*t),h=m)}}i.push(d),u=Math.max(u,d);for(var _=[],g=0;g<=f;g++){var v=0;"right"===this._font.align?v=u-i[g]:"center"===this._font.align&&(v=(u-i[g])/2),_.push(v)}for(var y=(this.tint,-1),b=0,S=o;b<S.length;b++){var O=S[b];O.drawRect.x=O.drawRect.x+_[O.line],y!==O.line&&(y=O.line,this._debugLevel>1&&this.drawGizmoRect(new n.Rectangle(O.drawRect.x-e.chars[O.charCode].xOffset*t,O.drawRect.y-e.chars[O.charCode].yOffset*t,i[y],e.lineHeight*t),1,65280,.5))}this._debugLevel>0&&this.drawGizmoRect(this.getLocalBounds(),1,16777215,.5),this._textWidth=u,this._textHeight=x,this._textMetricsBound=new n.Rectangle(0,0,u,x),this.vertices=this.toVertices(o),this.uvs=this.toUVs(o,a,s),this.indices=this.createIndicesForQuads(o.length),this.dirty++,this.indexDirty++},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.updateText()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontData",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glDatas",{get:function(){return this._glDatas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this._textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this._textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textMetric",{get:function(){return this._textMetricsBound},enumerable:!0,configurable:!0}),t.prototype.getBitmapTexture=function(e){var t=n.extras.BitmapText.fonts[e];if(!t)return n.Texture.EMPTY;var r=t.chars[Object.keys(t.chars)[0]].texture.baseTexture.imageUrl;return PIXI.utils.TextureCache[r]},t.prototype.toVertices=function(e){var t=this,r=new Float32Array(4*e.length*2),o=0;return e.forEach(function(e){var n=e.drawRect.x,i=e.drawRect.y,a=e.drawRect.width,s=e.drawRect.height;r[o++]=n,r[o++]=i,r[o++]=n,r[o++]=i+s,r[o++]=n+a,r[o++]=i+s,r[o++]=n+a,r[o++]=i,t._debugLevel>2&&t.drawGizmoRect(e.drawRect,1,170,.5)}),r},t.prototype.toUVs=function(e,t,r){var o=new Float32Array(4*e.length*2),n=0;return e.forEach(function(e){var i=e.rawRect.x/t,a=(e.rawRect.x+e.rawRect.width)/t,s=(e.rawRect.y+e.rawRect.height)/r,h=e.rawRect.y/r;o[n++]=i,o[n++]=h,o[n++]=i,o[n++]=s,o[n++]=a,o[n++]=s,o[n++]=a,o[n++]=h}),o},t.prototype.createIndicesForQuads=function(e){for(var t=6*e,r=new Uint16Array(t),o=0,n=0;o<t;o+=6,n+=4)r[o+0]=n+0,r[o+1]=n+1,r[o+2]=n+2,r[o+3]=n+0,r[o+4]=n+2,r[o+5]=n+3;return r},t.prototype.drawGizmoRect=function(e,t,r,o){void 0===t&&(t=1),void 0===r&&(r=16777215),void 0===o&&(o=1);var i=new n.Graphics;i.nativeLines=!0,i.lineStyle(t,r,o).drawRect(e.x,e.y,e.width,e.height),this.addChild(i)},t}(PIXI.mesh.Mesh);t.MSDFText=i},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),a=r(5),s=function(e){function t(t){var r=e.call(this,t)||this,o=r.renderer.gl;return r.shader=new PIXI.Shader(o,i,a),r}return o(t,e),t.prototype.onContextChange=function(){this.shader.gl=this.renderer.gl},t.prototype.render=function(e){var t=this.renderer,r=e.texture,o=e.fontData,i=t.gl;if(r&&r.valid&&o.rawSize){var a=e.glDatas[t.CONTEXT_UID];a||(a={shader:this.shader,vertexBuffer:n.glCore.GLBuffer.createVertexBuffer(i,e.vertices,i.STREAM_DRAW),uvBuffer:n.glCore.GLBuffer.createVertexBuffer(i,e.uvs,i.STREAM_DRAW),indexBuffer:n.glCore.GLBuffer.createIndexBuffer(i,e.indices,i.STATIC_DRAW),vao:null,dirty:e.dirty,indexDirty:e.indexDirty},a.vao=new n.glCore.VertexArrayObject(i).addIndex(a.indexBuffer).addAttribute(a.vertexBuffer,a.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(a.uvBuffer,a.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),e.glDatas[t.CONTEXT_UID]=a),t.bindVao(a.vao),e.dirty!==a.dirty&&(a.dirty=e.dirty,a.uvBuffer.upload(e.uvs)),e.indexDirty!==a.indexDirty&&(a.indexDirty=e.indexDirty,a.indexBuffer.upload(e.indices)),a.vertexBuffer.upload(e.vertices),t.bindShader(a.shader),a.shader.uniforms.uSampler=t.bindTexture(r),t.state&&t.state.setBlendMode(e.blendMode),a.shader.uniforms.translationMatrix=e.worldTransform.toArray(!0),a.shader.uniforms.u_alpha=e.worldAlpha,a.shader.uniforms.u_color=PIXI.utils.hex2rgb(o.color),a.shader.uniforms.u_fontSize=o.fontSize*e.scale.x,a.shader.uniforms.u_fontInfoSize=1,a.shader.uniforms.u_weight=o.weight,a.shader.uniforms.u_pxrange=o.pxrange,a.shader.uniforms.strokeWeight=o.strokeWeight,a.shader.uniforms.strokeColor=PIXI.utils.hex2rgb(o.strokeColor),a.shader.uniforms.tint=PIXI.utils.hex2rgb(e.tint),a.shader.uniforms.hasShadow=o.dropShadow,a.shader.uniforms.shadowOffset=new Float32Array([o.dropShadowOffset.x,o.dropShadowOffset.x]),a.shader.uniforms.shadowColor=PIXI.utils.hex2rgb(o.dropShadowColor),a.shader.uniforms.shadowAlpha=o.dropShadowAlpha,a.shader.uniforms.shadowSmoothing=o.dropShadowBlur;var s=e.drawMode=i.TRIANGLES;a.vao.draw(s,e.indices.length,0)}},t}(PIXI.ObjectRenderer);t.MSDFRenderer=s,PIXI.WebGLRenderer.registerPlugin("msdf",s)},function(e,t){e.exports="#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float u_fontInfoSize;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    vTextureCoord = aTextureCoord;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition * u_fontInfoSize, 1.0)).xy, 0.0, 1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform vec3 u_color;\nuniform sampler2D uSampler;\nuniform float u_alpha;\nuniform float u_fontSize;\nuniform float u_weight;\nuniform float u_pxrange;\n\nuniform vec3 tint;\n// Stroke effect parameters\nuniform float strokeWeight;\nuniform vec3 strokeColor;\n\n// Shadow effect parameters\nuniform bool hasShadow;\nuniform vec2 shadowOffset;\nuniform float shadowSmoothing;\nuniform vec3 shadowColor;\nuniform float shadowAlpha;\n\nfloat median(float r, float g, float b) {\n    return max(min(r, g), min(max(r, g), b));\n}\n\nvoid main(void)\n{\n    float smoothing = clamp(2.0 * u_pxrange / u_fontSize, 0.0, 0.5);\n\n    vec2 textureCoord = vTextureCoord * 2.;\n    vec3 sample = texture2D(uSampler, vTextureCoord).rgb;\n    float dist = median(sample.r, sample.g, sample.b);\n\n    float alpha;\n    vec3 color;\n\n    // dirty if statment, will change soon\n    if (strokeWeight > 0.0) {\n        alpha = smoothstep(strokeWeight - smoothing, strokeWeight + smoothing, dist);\n        float outlineFactor = smoothstep(u_weight - smoothing, u_weight + smoothing, dist);\n        color = mix(strokeColor, u_color, outlineFactor) * alpha;\n    } else {\n        alpha = smoothstep(u_weight - smoothing, u_weight + smoothing, dist);\n        color = u_color * alpha;\n    }\n    vec4 text = vec4(color * tint, alpha) * u_alpha;\n    if (hasShadow == false) {\n        gl_FragColor = text;\n    } else {\n        vec3 shadowSample = texture2D(uSampler, vTextureCoord - shadowOffset).rgb;\n        float shadowDist = median(shadowSample.r, shadowSample.g, shadowSample.b);\n        float distAlpha = smoothstep(0.5 - shadowSmoothing, 0.5 + shadowSmoothing, shadowDist);\n        vec4 shadow = vec4(shadowColor, shadowAlpha * distAlpha);\n        gl_FragColor = mix(shadow, text, text.a);\n    }\n}"}])});